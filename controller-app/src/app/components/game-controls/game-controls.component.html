<div class="gamepad-screen">
  <div class="header">
    <span>ROOM: {{ roomCode }}</span>
  </div>

  <!-- GAME OVER -->
  <div *ngIf="isGameOver" class="game-over-screen">
    <h2>GAME OVER</h2>
    <button (click)="restartGame()" class="btn-primary">RESTART GAME</button>
  </div>

  <!-- CONTROLS -->
  <div *ngIf="!isGameOver" class="controls-container">
    <!-- WAITING OVERLAY -->
    <div class="waiting-overlay" *ngIf="playersConnected < maxPlayers">
      <div class="waiting-card">
        <h2>PLAYER {{ playerIndex !== null ? playerIndex + 1 : '?' }}</h2>
        <div class="loader"></div>
        <p>CONNECTED!</p>
        <p class="sub">Waiting for Player {{ playersConnected === 1 ? '2' : '...' }}</p>
      </div>
    </div>

    <!-- PERMISSION MODAL -->
    <div class="permission-modal" *ngIf="!permissionGranted">
      <p>Tap below to enable steering control</p>
      <button (click)="requestPermission()" class="btn-primary">ENABLE GYRO</button>
      <p class="hint">(Or use buttons below if no gyro)</p>
    </div>

    <div class="controls">
      <button (touchstart)="steerLeft()" (touchend)="releaseSteer()" (mousedown)="steerLeft()"
        (mouseup)="releaseSteer()" [class.active]="isSteering === 'LEFT'" class="steer-btn left">
        ◀
      </button>

      <div class="status-indicator">
        <div [class.active]="isSteering === 'CENTER'" class="center-light"></div>
      </div>

      <button (touchstart)="steerRight()" (touchend)="releaseSteer()" (mousedown)="steerRight()"
        (mouseup)="releaseSteer()" [class.active]="isSteering === 'RIGHT'" class="steer-btn right">
        ▶
      </button>
    </div>

    <div class="speed-controls">
      <button (touchstart)="pressBrake()" (touchend)="releaseBrake()" (mousedown)="pressBrake()"
        (mouseup)="releaseBrake()" class="speed-btn brake-btn">
        <span class="icon">▼</span>
        <span class="label">BRAKE</span>
      </button>

      <button (touchstart)="pressGas()" (touchend)="releaseGas()" (mousedown)="pressGas()" (mouseup)="releaseGas()"
        class="speed-btn gas-btn">
        <span class="icon">▲</span>
        <span class="label">GAS</span>
      </button>
    </div>
  </div>
</div>